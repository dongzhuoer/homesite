---
title: Linear / Logistic Regression
author: Zhuoer Dong
date: '2018-11-12'
output: 
    blogdown::html_page:
        df_print: paged    
slug: linear-logistic-regression
categories: 2018
tags: []
authors: []
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/pagedtable/css/pagedtable.css" rel="stylesheet" />
<script src="/rmarkdown-libs/pagedtable/js/pagedtable.js"></script>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#getting-startted"><span class="toc-section-number">1</span> getting startted</a></li>
<li><a href="#linear-regression"><span class="toc-section-number">2</span> linear regression</a></li>
<li><a href="#general-linear-regression"><span class="toc-section-number">3</span> general linear regression</a></li>
<li><a href="#logistic-regression"><span class="toc-section-number">4</span> logistic regression</a></li>
<li><a href="#appendix"><span class="toc-section-number">5</span> appendix</a></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install needed R packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">update_packages</span>(<span class="fu">c</span>(<span class="st">&#39;magrittr&#39;</span>, <span class="st">&#39;tidyverse&#39;</span>, <span class="st">&#39;viridis&#39;</span>, <span class="st">&#39;plot3D&#39;</span>), <span class="at">upgrade =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="getting-startted" class="section level1" number="1">
<h1><span class="header-section-number">1</span> getting startted</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>(<span class="dv">20</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span></code></pre></div>
<p>This guide mainly show the code and plot, for more explanation, please refer to <a href="https://cloud.tsinghua.edu.cn/d/f361101fc62e49df960b/files/?p=/Lab%20Training/3.Linear_Logistic-Regression.pptx">this PPT</a> .</p>
</div>
<div id="linear-regression" class="section level1" number="2">
<h1><span class="header-section-number">2</span> linear regression</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span>sim1</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["int"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"4.199913"},{"1":"1","2":"7.510634"},{"1":"1","2":"2.125473"},{"1":"2","2":"8.988857"},{"1":"2","2":"10.243105"},{"1":"2","2":"11.296823"},{"1":"3","2":"7.356365"},{"1":"3","2":"10.505349"},{"1":"3","2":"10.511601"},{"1":"4","2":"12.434589"},{"1":"4","2":"11.892601"},{"1":"4","2":"14.257964"},{"1":"5","2":"19.130050"},{"1":"5","2":"11.738021"},{"1":"5","2":"16.024854"},{"1":"6","2":"13.273977"},{"1":"6","2":"15.955975"},{"1":"6","2":"16.894796"},{"1":"7","2":"20.085993"},{"1":"7","2":"17.171850"},{"1":"7","2":"19.936309"},{"1":"8","2":"21.725903"},{"1":"8","2":"18.390913"},{"1":"8","2":"22.475553"},{"1":"9","2":"26.777010"},{"1":"9","2":"22.805110"},{"1":"9","2":"21.128305"},{"1":"10","2":"24.968099"},{"1":"10","2":"23.346422"},{"1":"10","2":"21.975201"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelr<span class="sc">::</span>sim1, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;一元线性回归原始数据&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-lm-data-1.svg" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span>sim1 <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">dodge =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">20</span>, <span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x =</span> x <span class="sc">+</span> dodge, <span class="at">pred =</span> <span class="dv">7</span> <span class="sc">+</span> x<span class="sc">*</span><span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;grey40&quot;</span>) <span class="sc">+</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">7</span>, <span class="at">slope =</span> <span class="fl">1.5</span>, <span class="at">colour =</span> <span class="st">&quot;grey40&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> y, <span class="at">ymax =</span> pred), <span class="at">colour =</span> <span class="st">&quot;#3366FF&quot;</span>) <span class="sc">+</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;均方误差：衡量拟合效果&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/mean-square-error-1.svg" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sim1_dist <span class="ot">&lt;-</span> <span class="cf">function</span>(k, b) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    predicted <span class="ot">&lt;-</span> modelr<span class="sc">::</span>sim1 <span class="sc">%&gt;%</span> {.[ , <span class="sc">-</span><span class="fu">ncol</span>(.)]} <span class="sc">%&gt;%</span> <span class="fu">as.list</span>() <span class="sc">%T&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        {<span class="fu">names</span>(.) <span class="ot">&lt;-</span> <span class="cn">NULL</span>} <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">pmap_dbl</span>(. <span class="sc">%&gt;%</span> {k<span class="sc">*</span>. <span class="sc">+</span> b})</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    (modelr<span class="sc">::</span>sim1 <span class="sc">%&gt;%</span> {.[[<span class="fu">ncol</span>(.)]]} <span class="sc">-</span> predicted) <span class="sc">%&gt;%</span> .<span class="sc">^</span><span class="dv">2</span> <span class="sc">%&gt;%</span> mean</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="dv">25</span>;</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>sim1_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">b =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="at">length =</span> len), <span class="at">k =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="at">length =</span> len))</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sim1_grid <span class="sc">%&lt;&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dist =</span> purrr<span class="sc">::</span><span class="fu">map2_dbl</span>(k, b, sim1_dist)) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>sim1_grid <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(k, b)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> dist)) <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="at">name =</span> <span class="st">&#39;均方误差&#39;</span>) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;穷举法优化均方误差&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/all-MSE-1.svg" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sim1_grid <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(k, b)) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(sim1_grid, <span class="fu">rank</span>(dist) <span class="sc">&lt;=</span> <span class="dv">10</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> dist)) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="at">name =</span> <span class="st">&#39;均方误差&#39;</span>) <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;穷举法寻找最小的10个均方误差&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/min-MSE-1.svg" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>linear_aes <span class="ot">&lt;-</span> <span class="fu">aes</span>(<span class="at">intercept =</span> b, <span class="at">slope =</span> k)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelr<span class="sc">::</span>sim1, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(linear_aes, <span class="at">alpha =</span> <span class="fl">0.1</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">b =</span> <span class="fu">runif</span>(len<span class="sc">*</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">20</span>, <span class="dv">40</span>), <span class="at">k =</span> <span class="fu">runif</span>(len<span class="sc">*</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>))) <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(linear_aes, <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>, dplyr<span class="sc">::</span><span class="fu">filter</span>(sim1_grid, <span class="fu">rank</span>(dist) <span class="sc">&lt;=</span> <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;随机模型 vs 均方误差最小模型&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/MSE-min.vs.random-1.svg" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sim1_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, modelr<span class="sc">::</span>sim1)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sim1_coef <span class="ot">&lt;-</span> sim1_mod<span class="sc">$</span>coefficients</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelr<span class="sc">::</span>sim1, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> sim1_coef[<span class="dv">2</span>], <span class="at">intercept =</span> sim1_coef[<span class="dv">1</span>], </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">sprintf</span>(<span class="st">&#39;y = %.3f * x + %.3f&#39;</span>, sim1_coef[<span class="dv">2</span>], sim1_coef[<span class="dv">1</span>]))</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-lm-model-1.svg" width="672" /></p>
</div>
<div id="general-linear-regression" class="section level1" number="3">
<h1><span class="header-section-number">3</span> general linear regression</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>sim0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">10</span>) <span class="sc">%&gt;%</span> {tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> ., <span class="at">y =</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">4</span>))} <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">y =</span> <span class="fl">1.25</span> <span class="sc">^</span> y)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>sim0</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"8.9669720","2":"334.11634"},{"1":"2.6550866","2":"22.98731"},{"1":"3.7212390","2":"19.41045"},{"1":"5.7285336","2":"70.38327"},{"1":"9.0820779","2":"196.56619"},{"1":"2.0168193","2":"9.52874"},{"1":"8.9838968","2":"237.40096"},{"1":"9.4467527","2":"209.27172"},{"1":"6.6079779","2":"81.94782"},{"1":"6.2911404","2":"109.90718"},{"1":"0.6178627","2":"5.44800"},{"1":"2.0597457","2":"11.76640"},{"1":"1.7655675","2":"11.45957"},{"1":"6.8702285","2":"101.73123"},{"1":"3.8410372","2":"20.00808"},{"1":"7.6984142","2":"198.32613"},{"1":"4.9769924","2":"51.08758"},{"1":"7.1761851","2":"152.51678"},{"1":"9.9190609","2":"281.12922"},{"1":"3.8003518","2":"31.74488"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim0, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;广义线性回归原始数据&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-glm-data-1.svg" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim0, <span class="fu">aes</span>(x, <span class="fu">log</span>(y))) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;ln(y)&#39;</span>, <span class="at">title =</span> <span class="st">&#39;对因变量做对数变换&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-glm-data-2.svg" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sim0_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x, sim0)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sim0_coef <span class="ot">&lt;-</span> sim0_mod<span class="sc">$</span>coefficients;</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim0, <span class="fu">aes</span>(x, <span class="fu">log</span>(y))) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;ln(y)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> sim0_coef[<span class="dv">2</span>], <span class="at">intercept =</span> sim0_coef[<span class="dv">1</span>], </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">sprintf</span>(<span class="st">&#39;ln(y) = %.3f * x + %.3f&#39;</span>, sim0_coef[<span class="dv">2</span>], sim0_coef[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-glm-model-1.svg" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim0, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> . <span class="sc">%&gt;%</span> {<span class="fu">exp</span>(sim0_coef[<span class="dv">2</span>] <span class="sc">*</span> . <span class="sc">+</span> sim0_coef[<span class="dv">1</span>])}, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">sprintf</span>(<span class="st">&#39;y = exp(%.3f * x + %.3f)&#39;</span>, sim0_coef[<span class="dv">2</span>], sim0_coef[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-glm-model-2.svg" width="672" /></p>
</div>
<div id="logistic-regression" class="section level1" number="4">
<h1><span class="header-section-number">4</span> logistic regression</h1>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>iris_df <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(Species <span class="sc">!=</span> <span class="st">&#39;setosa&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">versicolor =</span> <span class="fu">as.integer</span>(Species <span class="sc">==</span> <span class="st">&#39;versicolor&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>, <span class="dv">4</span>, versicolor)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>iris_df</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Sepal.Width"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Petal.Width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["versicolor"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"3.2","2":"1.4","3":"1"},{"1":"3.2","2":"1.5","3":"1"},{"1":"3.1","2":"1.5","3":"1"},{"1":"2.3","2":"1.3","3":"1"},{"1":"2.8","2":"1.5","3":"1"},{"1":"2.8","2":"1.3","3":"1"},{"1":"3.3","2":"1.6","3":"1"},{"1":"2.4","2":"1.0","3":"1"},{"1":"2.9","2":"1.3","3":"1"},{"1":"2.7","2":"1.4","3":"1"},{"1":"2.0","2":"1.0","3":"1"},{"1":"3.0","2":"1.5","3":"1"},{"1":"2.2","2":"1.0","3":"1"},{"1":"2.9","2":"1.4","3":"1"},{"1":"2.9","2":"1.3","3":"1"},{"1":"3.1","2":"1.4","3":"1"},{"1":"3.0","2":"1.5","3":"1"},{"1":"2.7","2":"1.0","3":"1"},{"1":"2.2","2":"1.5","3":"1"},{"1":"2.5","2":"1.1","3":"1"},{"1":"3.2","2":"1.8","3":"1"},{"1":"2.8","2":"1.3","3":"1"},{"1":"2.5","2":"1.5","3":"1"},{"1":"2.8","2":"1.2","3":"1"},{"1":"2.9","2":"1.3","3":"1"},{"1":"3.0","2":"1.4","3":"1"},{"1":"2.8","2":"1.4","3":"1"},{"1":"3.0","2":"1.7","3":"1"},{"1":"2.9","2":"1.5","3":"1"},{"1":"2.6","2":"1.0","3":"1"},{"1":"2.4","2":"1.1","3":"1"},{"1":"2.4","2":"1.0","3":"1"},{"1":"2.7","2":"1.2","3":"1"},{"1":"2.7","2":"1.6","3":"1"},{"1":"3.0","2":"1.5","3":"1"},{"1":"3.4","2":"1.6","3":"1"},{"1":"3.1","2":"1.5","3":"1"},{"1":"2.3","2":"1.3","3":"1"},{"1":"3.0","2":"1.3","3":"1"},{"1":"2.5","2":"1.3","3":"1"},{"1":"2.6","2":"1.2","3":"1"},{"1":"3.0","2":"1.4","3":"1"},{"1":"2.6","2":"1.2","3":"1"},{"1":"2.3","2":"1.0","3":"1"},{"1":"2.7","2":"1.3","3":"1"},{"1":"3.0","2":"1.2","3":"1"},{"1":"2.9","2":"1.3","3":"1"},{"1":"2.9","2":"1.3","3":"1"},{"1":"2.5","2":"1.1","3":"1"},{"1":"2.8","2":"1.3","3":"1"},{"1":"3.3","2":"2.5","3":"0"},{"1":"2.7","2":"1.9","3":"0"},{"1":"3.0","2":"2.1","3":"0"},{"1":"2.9","2":"1.8","3":"0"},{"1":"3.0","2":"2.2","3":"0"},{"1":"3.0","2":"2.1","3":"0"},{"1":"2.5","2":"1.7","3":"0"},{"1":"2.9","2":"1.8","3":"0"},{"1":"2.5","2":"1.8","3":"0"},{"1":"3.6","2":"2.5","3":"0"},{"1":"3.2","2":"2.0","3":"0"},{"1":"2.7","2":"1.9","3":"0"},{"1":"3.0","2":"2.1","3":"0"},{"1":"2.5","2":"2.0","3":"0"},{"1":"2.8","2":"2.4","3":"0"},{"1":"3.2","2":"2.3","3":"0"},{"1":"3.0","2":"1.8","3":"0"},{"1":"3.8","2":"2.2","3":"0"},{"1":"2.6","2":"2.3","3":"0"},{"1":"2.2","2":"1.5","3":"0"},{"1":"3.2","2":"2.3","3":"0"},{"1":"2.8","2":"2.0","3":"0"},{"1":"2.8","2":"2.0","3":"0"},{"1":"2.7","2":"1.8","3":"0"},{"1":"3.3","2":"2.1","3":"0"},{"1":"3.2","2":"1.8","3":"0"},{"1":"2.8","2":"1.8","3":"0"},{"1":"3.0","2":"1.8","3":"0"},{"1":"2.8","2":"2.1","3":"0"},{"1":"3.0","2":"1.6","3":"0"},{"1":"2.8","2":"1.9","3":"0"},{"1":"3.8","2":"2.0","3":"0"},{"1":"2.8","2":"2.2","3":"0"},{"1":"2.8","2":"1.5","3":"0"},{"1":"2.6","2":"1.4","3":"0"},{"1":"3.0","2":"2.3","3":"0"},{"1":"3.4","2":"2.4","3":"0"},{"1":"3.1","2":"1.8","3":"0"},{"1":"3.0","2":"1.8","3":"0"},{"1":"3.1","2":"2.1","3":"0"},{"1":"3.1","2":"2.4","3":"0"},{"1":"3.1","2":"2.3","3":"0"},{"1":"2.7","2":"1.9","3":"0"},{"1":"3.2","2":"2.3","3":"0"},{"1":"3.3","2":"2.5","3":"0"},{"1":"3.0","2":"2.3","3":"0"},{"1":"2.5","2":"1.9","3":"0"},{"1":"3.0","2":"2.0","3":"0"},{"1":"3.4","2":"2.3","3":"0"},{"1":"3.0","2":"1.8","3":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris_df) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(Sepal.Width, Petal.Width, <span class="at">size =</span> <span class="fu">factor</span>(versicolor))) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">name =</span> <span class="st">&#39;versicolor&#39;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;0&#39;</span> <span class="ot">=</span> <span class="fl">0.5</span>, <span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;no&#39;</span>, <span class="st">&#39;yes&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;对数几率回归原始数据&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-logistic-data-1.svg" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>iris_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(versicolor <span class="sc">~</span> Sepal.Width <span class="sc">+</span> Petal.Width <span class="sc">+</span> <span class="dv">0</span>, <span class="at">data =</span> iris_df, <span class="at">family =</span> <span class="st">&#39;binomial&#39;</span>) </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>iris_coef <span class="ot">&lt;-</span> iris_model<span class="sc">$</span>coefficients</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>logistic_plot_base <span class="ot">&lt;-</span> iris_df <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    {tibble<span class="sc">::</span><span class="fu">add_column</span>(., <span class="at">probability =</span> <span class="fu">predict</span>(iris_model, .[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="st">&#39;response&#39;</span>))} <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Sepal.Width, Petal.Width)) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> probability, <span class="at">size =</span> <span class="fu">factor</span>(versicolor))) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(<span class="at">name =</span> <span class="st">&#39;versicolor&#39;</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;0&#39;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&#39;1&#39;</span> <span class="ot">=</span> <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;no&#39;</span>, <span class="st">&#39;yes&#39;</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>logistic_plot_base <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;使用 R 进行对数几率回归&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-logistic-model-1.svg" width="1152" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>logistic_plot_base <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="sc">-</span>iris_coef[<span class="dv">1</span>]<span class="sc">/</span>iris_coef[<span class="dv">2</span>], <span class="at">intercept =</span> <span class="fu">log</span>(<span class="dv">1</span>)<span class="sc">/</span>iris_coef[<span class="dv">2</span>]) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;对数几率回归中的“线性”部分&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-logistic-model-2.svg" width="1152" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>logistic_plot_base <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="sc">-</span><span class="dv">6</span><span class="sc">/-</span><span class="dv">10</span>, <span class="at">intercept =</span> <span class="fu">log</span>(<span class="dv">1</span>)<span class="sc">/-</span><span class="dv">20</span>) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">/-</span><span class="dv">12</span>, <span class="at">intercept =</span> <span class="fu">log</span>(<span class="dv">1</span>)<span class="sc">/-</span><span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;两种对数几率模型中“线性”部分的比较&#39;</span>)</span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/plot-logistic-model-3.svg" width="1152" /></p>
</div>
<div id="appendix" class="section level1" number="5">
<h1><span class="header-section-number">5</span> appendix</h1>
<p>I have tried to use 3D plot to show min MSE:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/plot3D/vignettes/plot3D.pdf">plot3D</a></li>
<li><a href="https://cran.r-project.org/web/packages/scatterplot3d/vignettes/s3d.pdf">scatterplot3d</a></li>
</ul>
<p>I preserve the following code to show how to plot 3D surface with your own data</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sim1_grid)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["b"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["k"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dist"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"-5.0000000","2":"1","3":"238.7790","_rn_":"1"},{"1":"-3.9583333","2":"1","3":"208.6052","_rn_":"2"},{"1":"-2.9166667","2":"1","3":"180.6015","_rn_":"3"},{"1":"-1.8750000","2":"1","3":"154.7680","_rn_":"4"},{"1":"-0.8333333","2":"1","3":"131.1047","_rn_":"5"},{"1":"0.2083333","2":"1","3":"109.6114","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sim1_grid <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">spread</span>(<span class="st">&#39;b&#39;</span>, <span class="st">&#39;dist&#39;</span>) <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&#39;k&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    {plot3D<span class="sc">::</span><span class="fu">surf3D</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">rownames</span>(.), len) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(), <span class="at">ncol =</span> len),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">colnames</span>(.), len) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(), <span class="at">ncol =</span> len, <span class="at">byrow =</span> T),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        .</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    )} </span></code></pre></div>
<p><img src="/post/2018/11-12-linear-logistic-regression_files/figure-html/all-MSE-surfplot-1.svg" width="672" /></p>
</div>
